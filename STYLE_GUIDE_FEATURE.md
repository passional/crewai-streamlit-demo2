# 文风参考功能说明

## 功能概述

为CrewAI-Streamlit演示项目添加了文风参考功能，允许用户在生成中文口播稿时上传参考文本，系统会分析并模仿其风格特点。

## 主要特性

### 1. 文风参考支持
- **多语言支持**：支持中文或英文参考文本
- **智能分析**：AI会分析参考文本的结构、开头方式、叙事风格、语言特色
- **风格转化**：如果参考文本是英文，会将其风格特点转化为符合中文表达习惯的方式

### 2. 上传方式
- **文风库选择**：从预设的文风库中选择
- **临时上传**：支持上传.md或.txt格式的参考文件
- **灵活处理**：如果用户未上传，提示词中显示"无"

### 3. 分析维度
AI会重点分析以下方面：
- 开头的引入方式和节奏
- 段落的组织结构
- 语言的表达风格和用词习惯
- 内容展开的逻辑方式

## 修改的文件

### 1. `src/tasks/story_tasks.py`
**主要修改：**
- 在任务描述中添加文风参考部分
- 增加文风分析和模仿的详细要求
- 支持中英文参考文本的处理
- 明确段落结构要求

**关键改进：**
```python
**文风参考 (Style Guide)：**
    {style_guide if style_guide else "无"}
-------------------------

1. **文风参考**: 如果提供了文风参考，请仔细分析其结构、开头方式、叙事风格、语言特色等，并在创作中模仿和借鉴这些特点。
```

### 2. `src/agents/story_agent.py`
**主要修改：**
- 增强agent的文风分析能力
- 添加中英文风格转化能力
- 强调文风模仿的专业性

**关键改进：**
```python
"你特别擅长分析和模仿不同的文风特色，能够从提供的参考文本中提取出结构特点、表达方式、开头技巧等，并将这些特点融入到中文科学传播内容中。"
"无论参考文本是中文还是英文，你都能准确把握其精髓，并转化为符合中文表达习惯的优质内容。"
```

### 3. `app.py`
**主要修改：**
- 更新文件上传提示，明确支持中英文
- 修改按钮文字为"生成中文口播稿"
- 优化文风处理逻辑
- 添加帮助提示

**关键改进：**
```python
uploaded_style_file = st.sidebar.file_uploader(
    "或，临时上传文风参考 (支持中文或英文文本)",
    type=['md', 'txt'],
    help="上传的文风参考将用于指导中文口播稿的创作风格、结构和表达方式"
)
```

## 使用流程

### 1. 准备文风参考（可选）
- 准备中文或英文的参考文本
- 可以是其他优秀的科普文章、口播稿等
- 支持.md或.txt格式

### 2. 上传参考文件
- 在第二步"生成中文口播稿"时
- 可以从文风库选择或临时上传文件
- 系统会自动处理中英文差异

### 3. 生成口播稿
- AI会分析参考文本的特点
- 结合视频大纲生成符合参考风格的中文口播稿
- 保持科学传播的专业性

### 4. 效果体现
生成的中文口播稿会体现参考文本的：
- 开头引入方式
- 段落组织结构
- 语言表达风格
- 内容展开逻辑

## 技术要点

### 1. 智能风格分析
- AI能够识别文本的深层结构特征
- 不仅仅是表面的词汇模仿
- 重点关注逻辑展开和表达方式

### 2. 跨语言风格转化
- 英文参考文本的风格特点会被转化为中文表达
- 保持原有的逻辑结构和表达节奏
- 符合中文读者的阅读习惯

### 3. 灵活处理
- 如果未上传参考文件，系统正常工作
- 参考文件作为辅助，不会覆盖基本的科学传播要求
- 保持内容的专业性和准确性

## 优势

1. **个性化定制**：用户可以根据自己的喜好选择文风
2. **学习能力强**：AI能够快速学习和模仿不同的写作风格
3. **跨语言支持**：支持中英文参考，扩大了可用资源范围
4. **保持专业性**：在模仿风格的同时保持科学传播的严谨性
5. **易于使用**：简单的文件上传即可实现风格定制

这个功能大大增强了系统的灵活性和个性化能力，让用户能够创作出更符合自己风格偏好的高质量中文科学传播内容。
